<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
      sans-serif;
    }
    .backdrop {
      background: rgba(0, 0, 0, 0.45);
    }
  </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen">
<!-- HEADER -------------------------------------------------------------->
<header class="bg-white shadow-sm sticky top-0 z-20">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
    <div class="flex flex-col">
      <span class="text-lg font-semibold text-indigo-700">
        ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
      </span>
      <span class="text-xs text-slate-500">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ (‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤ 4 ‡∏ä‡πà‡∏ß‡∏á)</span>
    </div>
    <div class="flex gap-2">
      <button
        id="btn-open-config"
        class="px-3 py-1.5 text-xs rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
      >
        ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL
      </button>
      <button
        id="btn-reset-url"
        class="px-3 py-1.5 text-xs rounded-md border border-red-300 text-red-600 hover:bg-red-50"
      >
        Reset URL
      </button>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 pt-6 pb-10 space-y-6">

  <!-- FRONT PAGE : ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ---------------------------------->
  <section id="front-page" class="space-y-6">
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å -->
    <div class="bg-white rounded-xl shadow-sm p-4 flex flex-wrap gap-3">
      <button
        id="btn-open-manual-log"
        class="px-5 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm shadow-sm"
      >
        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ (‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡πÅ‡∏Å‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
      </button>

      <button
        id="btn-open-checktime"
        class="px-5 py-3 bg-sky-500 hover:bg-sky-600 text-white rounded-lg text-sm shadow-sm"
      >
        ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
      </button>

      <button
        id="btn-open-admin-login"
        class="px-5 py-3 bg-slate-800 hover:bg-slate-900 text-white rounded-lg text-sm shadow-sm ml-auto"
      >
        ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà / HR
      </button>
    </div>

    <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å) -->
    <section class="bg-white rounded-xl shadow-sm p-4 space-y-3">
      <h2 class="font-semibold text-lg">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
      <p class="text-xs text-slate-500">
        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏ä‡πà‡∏ß‡∏¢‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß)
      </p>
      <div class="grid sm:grid-cols-2 gap-3 text-sm">
        <div class="space-y-1">
          <div class="flex justify-between">
            <span class="text-slate-500">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</span>
            <span id="last-log-code" class="font-medium">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-500">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</span>
            <span id="last-log-name" class="font-medium">-</span>
          </div>
        </div>
        <div class="space-y-1">
          <div class="flex justify-between">
            <span class="text-slate-500">‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥:</span>
            <span id="last-log-type" class="font-medium">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-500">‡πÄ‡∏ß‡∏•‡∏≤:</span>
            <span id="last-log-time" class="font-medium">-</span>
          </div>
        </div>
      </div>
      <p id="last-log-status" class="text-xs text-emerald-600 mt-1"></p>
    </section>

    <!-- Dashboard ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó -->
    <section class="bg-white rounded-xl shadow-sm p-4 space-y-3">
      <div class="flex justify-between items-center">
        <h2 class="font-semibold text-lg">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏¢‡πà‡∏≠)</h2>
        <button
          id="btn-refresh-front-dashboard"
          class="px-3 py-1.5 text-xs rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
        >
          ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
      </div>

      <div id="front-dashboard-summary" class="text-sm text-slate-600">
        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
      </div>

      <div class="overflow-auto">
        <table class="min-w-full text-xs border mt-2">
          <thead class="bg-slate-50">
          <tr>
            <th class="border px-2 py-1">‡∏£‡∏´‡∏±‡∏™</th>
            <th class="border px-2 py-1">‡∏ä‡∏∑‡πà‡∏≠</th>
            <th class="border px-2 py-1">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πâ‡∏≤</th>
            <th class="border px-2 py-1">‡∏≠‡∏≠‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</th>
            <th class="border px-2 py-1">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</th>
            <th class="border px-2 py-1">‡∏≠‡∏≠‡∏Å‡πÄ‡∏¢‡πá‡∏ô</th>
            <th class="border px-2 py-1">‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô</th>
          </tr>
          </thead>
          <tbody id="front-today-logs-body"></tbody>
        </table>
      </div>
    </section>
  </section>

  <!-- ADMIN PAGE : ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà / HR ---------------------------------->
  <section id="admin-page" class="hidden h-[calc(100vh-5rem)]">
    <div class="flex h-full rounded-xl overflow-hidden shadow-sm">
      <!-- SIDEBAR -->
      <aside class="w-60 bg-slate-900 text-slate-100 flex flex-col">
        <div class="px-4 py-4 border-b border-slate-800">
          <h2 class="font-semibold text-base">Admin Panel</h2>
          <p class="text-[11px] text-slate-400">
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö HR / ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
          </p>
        </div>
        <nav class="flex-1 text-sm">
          <button
            id="admin-nav-dashboard"
            class="w-full flex items-center gap-2 px-4 py-2.5 hover:bg-slate-800 text-left bg-slate-800"
          >
            <span>üìä</span> <span>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span>
          </button>
          <button
            id="admin-nav-employees"
            class="w-full flex items-center gap-2 px-4 py-2.5 hover:bg-slate-800 text-left"
          >
            <span>üë•</span> <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span>
          </button>
          <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á -->
        </nav>
        <div class="p-4 border-t border-slate-800">
          <button
            id="btn-admin-logout"
            class="w-full px-3 py-2 bg-red-500 hover:bg-red-600 rounded-lg text-sm"
          >
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
          </button>
        </div>
      </aside>

      <!-- CONTENT -->
      <div class="flex-1 bg-slate-50 flex flex-col">
        <!-- top bar -->
        <div class="h-12 flex items-center justify-between px-4 border-b bg-white">
          <span class="text-sm font-medium">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, <span class="text-indigo-600">Admin</span></span>
          <span id="admin-date-label" class="text-xs text-slate-500"></span>
        </div>

        <div class="flex-1 overflow-auto p-4 space-y-4">
          <!-- DASHBOARD -->
          <div id="admin-dashboard" class="space-y-4">
            <div class="grid sm:grid-cols-4 gap-3 text-sm">
              <div class="bg-white rounded-xl shadow-sm p-3 border border-slate-100">
                <p class="text-xs text-slate-500">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <p id="admin-card-total-emp" class="text-2xl font-semibold mt-1">-</p>
              </div>
              <div class="bg-white rounded-xl shadow-sm p-3 border border-slate-100">
                <p class="text-xs text-slate-500">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                <p id="admin-card-total-logs" class="text-2xl font-semibold mt-1">-</p>
              </div>
              <div class="bg-white rounded-xl shadow-sm p-3 border border-slate-100">
                <p class="text-xs text-slate-500">‡∏°‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥</p>
                <p id="admin-card-normal" class="text-2xl font-semibold mt-1">-</p>
              </div>
              <div class="bg-white rounded-xl shadow-sm p-3 border border-slate-100">
                <p class="text-xs text-slate-500">‡∏°‡∏µ‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ / ‡∏Ç‡∏≤‡∏î</p>
                <p id="admin-card-abnormal" class="text-2xl font-semibold mt-1">-</p>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-4 border border-slate-100">
              <div class="flex justify-between items-center mb-2">
                <h3 class="font-semibold text-base">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                <button
                  id="btn-admin-refresh"
                  class="px-3 py-1.5 text-xs rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
                >
                  ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                </button>
              </div>
              <div class="overflow-auto max-h-[420px]">
                <table class="min-w-full text-xs border">
                  <thead class="bg-slate-50">
                  <tr>
                    <th class="border px-2 py-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                    <th class="border px-2 py-1">‡∏£‡∏´‡∏±‡∏™</th>
                    <th class="border px-2 py-1">‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th class="border px-2 py-1">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πâ‡∏≤</th>
                    <th class="border px-2 py-1">‡∏≠‡∏≠‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</th>
                    <th class="border px-2 py-1">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</th>
                    <th class="border px-2 py-1">‡∏≠‡∏≠‡∏Å‡πÄ‡∏¢‡πá‡∏ô</th>
                    <th class="border px-2 py-1">‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô</th>
                  </tr>
                  </thead>
                  <tbody id="admin-today-logs-body"></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- EMPLOYEES -->
          <div id="admin-employees" class="hidden space-y-3">
            <div class="flex justify-between items-center">
              <h3 class="font-semibold text-base">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
              <div class="flex gap-2">
                <button
                  id="btn-admin-emp-refresh"
                  class="px-3 py-1.5 text-xs rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
                >
                  ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                </button>
                <button
                  id="btn-admin-emp-add"
                  class="px-3 py-1.5 text-xs rounded-md bg-emerald-500 text-white hover:bg-emerald-600"
                >
                  + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
                </button>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-slate-100">
              <div class="overflow-auto max-h-[460px]">
                <table class="min-w-full text-xs border">
                  <thead class="bg-slate-50">
                  <tr>
                    <th class="border px-2 py-1">‡∏£‡∏´‡∏±‡∏™</th>
                    <th class="border px-2 py-1">‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th class="border px-2 py-1">‡πÅ‡∏ú‡∏ô‡∏Å</th>
                    <th class="border px-2 py-1">‡∏£‡∏∞‡∏î‡∏±‡∏ö</th>
                    <th class="border px-2 py-1">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                    <th class="border px-2 py-1">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                  </tr>
                  </thead>
                  <tbody id="admin-emp-table-body"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>
</main>

<!-- MODALS -------------------------------------------------------------->

<!-- Modal ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Web App URL -->
<div
  id="config-modal"
  class="fixed inset-0 hidden items-center justify-center z-30"
>
  <div class="backdrop absolute inset-0"></div>
  <div
    class="relative bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-5 space-y-4 z-10"
  >
    <h2 class="font-semibold text-lg">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Apps Script</h2>
    <p class="text-sm text-slate-600">
      ‡∏ß‡∏≤‡∏á
      <span class="font-mono text-xs bg-slate-100 px-1 py-0.5 rounded">Web App URL</span>
      ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Apps Script
      (‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ <code class="text-xs bg-slate-100 px-1 rounded">/exec</code>
      ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô <strong>Anyone</strong>)
    </p>

    <div class="space-y-1">
      <label class="text-xs text-slate-500">Web App URL</label>
      <input
        id="webapp-url-input"
        type="text"
        class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm"
        placeholder="https://script.google.com/macros/s/XXXXX/exec"
      />
      <p id="webapp-url-error" class="text-xs text-red-500"></p>
      <p id="webapp-url-success" class="text-xs text-emerald-600"></p>
    </div>

    <div class="flex justify-end gap-2 pt-2">
      <button
        id="btn-config-cancel"
        class="px-3 py-1.5 text-xs rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
      >
        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
      </button>
      <button
        id="btn-config-save"
        class="px-3 py-1.5 text-xs rounded-md bg-indigo-600 text-white hover:bg-indigo-700"
      >
        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö
      </button>
    </div>
  </div>
</div>

<!-- Modal Login Admin -->
<div
  id="admin-login-modal"
  class="fixed inset-0 hidden items-center justify-center z-30"
>
  <div class="backdrop absolute inset-0"></div>
  <div class="relative bg-white rounded-xl shadow-xl max-w-sm w-full mx-4 p-5 space-y-4 z-10">
    <h2 class="font-semibold text-lg">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà / HR</h2>
    <p class="text-sm text-slate-600">‡πÄ‡∏î‡πÇ‡∏°: <span class="font-mono text-xs bg-slate-100 px-1 rounded">admin / 1234</span></p>

    <div class="space-y-2 text-sm">
      <div>
        <label class="text-xs text-slate-500">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
        <input
          id="admin-login-user"
          type="text"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          placeholder="admin"
        />
      </div>
      <div>
        <label class="text-xs text-slate-500">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
        <input
          id="admin-login-pass"
          type="password"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        />
      </div>
      <p id="admin-login-error" class="text-xs text-red-500"></p>
    </div>

    <div class="flex justify-end gap-2 pt-2 text-xs">
      <button
        id="btn-admin-login-cancel"
        class="px-3 py-1.5 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
      >
        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
      </button>
      <button
        id="btn-admin-login-submit"
        class="px-3 py-1.5 rounded-md bg-slate-800 text-white hover:bg-slate-900"
      >
        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
      </button>
    </div>
  </div>
</div>

<!-- Modal ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ -->
<div
  id="manual-log-modal"
  class="fixed inset-0 hidden items-center justify-center z-30"
>
  <div class="backdrop absolute inset-0"></div>
  <div class="relative bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 p-5 space-y-4 z-10">
    <h2 class="font-semibold text-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠</h2>
    <p class="text-xs text-slate-500">
      ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡πÅ‡∏Å‡∏ô‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ / ‡∏•‡∏∑‡∏°‡∏™‡πÅ‡∏Å‡∏ô ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö
    </p>

    <div class="space-y-3 text-sm">
      <div class="flex gap-2 items-end">
        <div class="flex-1">
          <label class="text-xs text-slate-500">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
          <input
            id="manual-code-input"
            type="text"
            class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
            placeholder="‡πÄ‡∏ä‡πà‡∏ô 1011"
          />
        </div>
        <button
          id="btn-manual-find-emp"
          class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm"
        >
          ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        </button>
      </div>

      <div
        id="manual-emp-box"
        class="border border-slate-200 rounded-lg px-3 py-2 bg-slate-50 text-xs text-slate-700"
      >
        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™
      </div>

      <div>
        <label class="text-xs text-slate-500">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡πÇ‡∏ô‡πâ‡∏ï‡πÄ‡∏â‡∏¢ ‡πÜ)</label>
        <select
          id="manual-type-select"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2 text-sm"
        >
          <option value="AUTO">‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</option>
          <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πâ‡∏≤">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πâ‡∏≤</option>
          <option value="‡∏≠‡∏≠‡∏Å‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á">‡∏≠‡∏≠‡∏Å‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</option>
          <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á</option>
          <option value="‡∏≠‡∏≠‡∏Å‡πÄ‡∏¢‡πá‡∏ô">‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</option>
        </select>
        <p class="text-[11px] text-slate-500 mt-1">
          ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ô‡πâ‡∏ï‡πÉ‡∏´‡πâ HR ‡∏î‡∏π‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ)
        </p>
      </div>

      <div>
        <label class="text-xs text-slate-500">‡∏£‡∏π‡∏õ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô / ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label>
        <input
          id="manual-proof-input"
          type="file"
          accept="image/*"
          class="mt-1 block w-full text-xs"
        />
        <p class="text-[11px] text-slate-500 mt-1">
          ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡∏∂‡πâ‡∏ô Drive ‡πÅ‡∏Ñ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô (‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ)
        </p>
      </div>

      <p id="manual-status" class="text-xs text-emerald-600"></p>
    </div>

    <div class="flex justify-end gap-2 pt-2 text-xs">
      <button
        id="btn-manual-cancel"
        class="px-3 py-1.5 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
      >
        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
      </button>
      <button
        id="btn-manual-submit"
        class="px-3 py-1.5 rounded-md bg-emerald-500 text-white hover:bg-emerald-600"
      >
        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
      </button>
    </div>
  </div>
</div>

<!-- Modal ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ -->
<div
  id="checktime-modal"
  class="fixed inset-0 hidden items-center justify-center z-30"
>
  <div class="backdrop absolute inset-0"></div>
  <div class="relative bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-5 space-y-4 z-10">
    <h2 class="font-semibold text-lg">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>

    <div class="space-y-3 text-sm">
      <div class="flex gap-2 items-end">
        <div class="flex-1">
          <label class="text-xs text-slate-500">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
          <input
            id="checktime-code-input"
            type="text"
            class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
            placeholder="‡πÄ‡∏ä‡πà‡∏ô 1011"
          />
        </div>
        <button
          id="btn-checktime-submit"
          class="px-4 py-2 bg-sky-500 hover:bg-sky-600 text-white rounded-lg text-sm"
        >
          ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        </button>
      </div>

      <div
        id="checktime-result"
        class="border border-slate-200 rounded-lg px-3 py-2 bg-slate-50 text-xs text-slate-700 min-h-[72px]"
      >
        ‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á ‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£
      </div>
    </div>

    <div class="flex justify-end pt-2 text-xs">
      <button
        id="btn-checktime-close"
        class="px-3 py-1.5 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
      >
        ‡∏õ‡∏¥‡∏î
      </button>
    </div>
  </div>
</div>

<!-- Modal ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô) -->
<div
  id="employee-modal"
  class="fixed inset-0 hidden items-center justify-center z-30"
>
  <div class="backdrop absolute inset-0"></div>
  <div
    class="relative bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 p-5 space-y-4 z-10"
  >
    <div class="flex justify-between items-center">
      <h2 class="font-semibold text-lg">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
      <button
        id="btn-employee-close"
        class="text-sm text-slate-500 hover:text-slate-800"
      >
        ‚úï ‡∏õ‡∏¥‡∏î
      </button>
    </div>

    <form id="employee-form" class="grid md:grid-cols-2 gap-4 text-sm">
      <input type="hidden" id="emp-id" />

      <div>
        <label class="block text-xs text-slate-500">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
        <input
          id="emp-code"
          type="text"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          required
        />
      </div>

      <div>
        <label class="block text-xs text-slate-500">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
        <input
          id="emp-name"
          type="text"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          required
        />
      </div>

      <div>
        <label class="block text-xs text-slate-500">‡πÅ‡∏ú‡∏ô‡∏Å</label>
        <select
          id="emp-branch"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          required
        >
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option>
        </select>
      </div>

      <div>
        <label class="block text-xs text-slate-500">‡∏£‡∏∞‡∏î‡∏±‡∏ö</label>
        <select
          id="emp-level"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
          required
        >
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö --</option>
        </select>
      </div>

      <div>
        <label class="block text-xs text-slate-500">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
        <input
          id="emp-email"
          type="email"
          class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2"
        />
      </div>

      <div>
        <label class="block text-xs text-slate-500">‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢ (‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á)</label>
        <input
          id="emp-photo"
          type="file"
          accept="image/*"
          class="mt-1 block w-full text-xs"
        />
        <p class="text-[11px] text-slate-500 mt-1">
          ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡∏∂‡πâ‡∏ô Drive ‡πÅ‡∏Ñ‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏π‡πâ‡∏à‡∏≥‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
        </p>
      </div>
    </form>

    <div class="flex justify-between items-center pt-2 text-xs">
      <div id="employee-form-status" class="text-slate-500"></div>
      <div class="flex gap-2">
        <button
          id="btn-employee-cancel"
          class="px-3 py-1.5 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50"
        >
          ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
        </button>
        <button
          id="btn-employee-save"
          class="px-3 py-1.5 rounded-md bg-emerald-500 text-white hover:bg-emerald-600"
        >
          ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
        </button>
      </div>
    </div>

    <hr class="my-3" />

    <div class="overflow-auto max-h-64 text-xs">
      <table class="min-w-full border">
        <thead class="bg-slate-50">
        <tr>
          <th class="border px-2 py-1">‡∏£‡∏´‡∏±‡∏™</th>
          <th class="border px-2 py-1">‡∏ä‡∏∑‡πà‡∏≠</th>
          <th class="border px-2 py-1">‡πÅ‡∏ú‡∏ô‡∏Å</th>
          <th class="border px-2 py-1">‡∏£‡∏∞‡∏î‡∏±‡∏ö</th>
          <th class="border px-2 py-1">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
        </tr>
        </thead>
        <tbody id="employee-table-body"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- SCRIPT -------------------------------------------------------------->
<script>
  /**********************
   * STATE ‡∏Å‡∏•‡∏≤‡∏á
   **********************/
  const LS_KEY_URL = "faceAttendance:webAppUrl";
  const ADMIN_USER = "admin";
  const ADMIN_PASS = "1234";

  let webAppUrl = "";
  let isAdminLoggedIn = false;

  let state = {
    employees: [],
    branches: [],
    levels: [],
    todayLogs: [],
  };

  let manualSelectedEmp = null; // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö modal ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠

  /**********************
   * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
   **********************/
  async function callApi(action, payload = {}) {
    if (!webAppUrl) {
      throw new Error("NOT_CONFIGURED");
    }

    const params = new URLSearchParams();
    params.append("action", action);
    Object.entries(payload).forEach(([k, v]) => {
      params.append(k, typeof v === "object" ? JSON.stringify(v) : v);
    });

    const res = await fetch(webAppUrl, {
      method: "POST",
      body: params,
    });

    if (!res.ok) {
      throw new Error("HTTP " + res.status);
    }
    const data = await res.json();
    if (!data.ok) {
      throw new Error(data.error || "API error");
    }
    return data.result;
  }

  /**********************
   * Modal helper
   **********************/
  function openModal(el) {
    el.classList.remove("hidden");
    el.classList.add("flex");
  }
  function closeModal(el) {
    el.classList.add("hidden");
    el.classList.remove("flex");
  }

  /**********************
   * ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ / ‡∏ó‡∏î‡∏™‡∏≠‡∏ö URL
   **********************/
  async function onSaveWebAppUrl() {
    const input = document.getElementById("webapp-url-input");
    const url = input.value.trim();
    const errorEl = document.getElementById("webapp-url-error");
    const successEl = document.getElementById("webapp-url-success");
    errorEl.textContent = "";
    successEl.textContent = "";

    if (!url || !url.startsWith("https://script.google.com/macros/s/")) {
      errorEl.textContent =
        "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å Apps Script (‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ https://script.google.com/macros/s/ ‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ /exec)";
      return;
    }
    if (!url.endsWith("/exec")) {
      errorEl.textContent = "URL ‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ /exec";
      return;
    }

    webAppUrl = url;
    try {
      await callApi("ping");
      localStorage.setItem(LS_KEY_URL, url);
      successEl.textContent = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...";
      await loadInitialData();
      setTimeout(() => {
        closeModal(document.getElementById("config-modal"));
      }, 600);
    } catch (err) {
      console.error(err);
      errorEl.textContent = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
    }
  }

  function resetUrl() {
    localStorage.removeItem(LS_KEY_URL);
    webAppUrl = "";
    document.getElementById("webapp-url-input").value = "";
    document.getElementById("webapp-url-error").textContent = "";
    document.getElementById("webapp-url-success").textContent = "";
    openModal(document.getElementById("config-modal"));
  }

  /**********************
   * ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å API
   **********************/
  async function loadInitialData() {
    if (!webAppUrl) return;
    try {
      const result = await callApi("getInitialData");
      state.employees = result.employees || [];
      state.branches = result.branches || [];
      state.levels = result.levels || [];
      state.todayLogs = result.todayLogs || [];

      renderEmployeesTableInModal();
      renderBranchesLevelsToForm();
      renderFrontDashboard();
      renderAdminDashboard();
      renderAdminEmployeeTable();
    } catch (err) {
      console.error(err);
      document.getElementById("front-dashboard-summary").textContent =
        "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
    }
  }

  /**********************
   * Render ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á ‡πÜ
   **********************/
  function renderEmployeesTableInModal() {
    const tbody = document.getElementById("employee-table-body");
    if (!tbody) return;
    tbody.innerHTML = "";
    state.employees.forEach((emp) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="border px-2 py-1">${emp.code || ""}</td>
        <td class="border px-2 py-1">${emp.fullName || ""}</td>
        <td class="border px-2 py-1">${emp.branch || ""}</td>
        <td class="border px-2 py-1">${emp.level || ""}</td>
        <td class="border px-2 py-1">${emp.email || ""}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function renderBranchesLevelsToForm() {
    const branchSelect = document.getElementById("emp-branch");
    const levelSelect = document.getElementById("emp-level");

    if (!branchSelect || !levelSelect) return;

    branchSelect.innerHTML = `<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option>`;
    state.branches.forEach((b) => {
      const opt = document.createElement("option");
      opt.value = b.name || b.id || "";
      opt.textContent = b.name || "";
      branchSelect.appendChild(opt);
    });

    levelSelect.innerHTML = `<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö --</option>`;
    state.levels.forEach((l) => {
      const opt = document.createElement("option");
      opt.value = l.name || l.id || "";
      opt.textContent = l.name || "";
      levelSelect.appendChild(opt);
    });
  }

  // dashboard ‡∏¢‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤
  function renderFrontDashboard() {
    const summaryEl = document.getElementById("front-dashboard-summary");
    const body = document.getElementById("front-today-logs-body");
    if (!summaryEl || !body) return;

    body.innerHTML = "";

    const count = state.todayLogs.length;
    if (count === 0) {
      summaryEl.textContent = "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤";
    } else {
      summaryEl.textContent = `‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß ${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
    }

    state.todayLogs.forEach((log) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="border px-2 py-1">${log.code || ""}</td>
        <td class="border px-2 py-1">${log.fullName || ""}</td>
        <td class="border px-2 py-1">${log.t1 || ""}</td>
        <td class="border px-2 py-1">${log.t2 || ""}</td>
        <td class="border px-2 py-1">${log.t3 || ""}</td>
        <td class="border px-2 py-1">${log.t4 || ""}</td>
        <td class="border px-2 py-1">${log.statusDay || ""}</td>
      `;
      body.appendChild(tr);
    });
  }

  // dashboard admin
  function renderAdminDashboard() {
    const totalEmpEl = document.getElementById("admin-card-total-emp");
    const totalLogsEl = document.getElementById("admin-card-total-logs");
    const normalEl = document.getElementById("admin-card-normal");
    const abnormalEl = document.getElementById("admin-card-abnormal");
    const body = document.getElementById("admin-today-logs-body");
    const dateLabel = document.getElementById("admin-date-label");

    if (dateLabel) {
      const d = new Date();
      dateLabel.textContent =
        d.toLocaleDateString("th-TH", {
          year: "numeric",
          month: "short",
          day: "numeric",
        }) + " ‡πÄ‡∏ß‡∏•‡∏≤ " + d.toLocaleTimeString("th-TH", { hour: "2-digit", minute: "2-digit" });
    }

    if (!totalEmpEl || !totalLogsEl || !body) return;

    totalEmpEl.textContent = state.employees.length;
    totalLogsEl.textContent = state.todayLogs.length;

    let normal = 0;
    let abnormal = 0;

    state.todayLogs.forEach((log) => {
      if (log.statusDay === "‡∏õ‡∏Å‡∏ï‡∏¥") normal++;
      else if (log.statusDay) abnormal++;
    });

    if (normalEl) normalEl.textContent = normal;
    if (abnormalEl) abnormalEl.textContent = abnormal;

    body.innerHTML = "";
    state.todayLogs.forEach((log) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="border px-2 py-1">${log.date || ""}</td>
        <td class="border px-2 py-1">${log.code || ""}</td>
        <td class="border px-2 py-1">${log.fullName || ""}</td>
        <td class="border px-2 py-1">${log.t1 || ""}</td>
        <td class="border px-2 py-1">${log.t2 || ""}</td>
        <td class="border px-2 py-1">${log.t3 || ""}</td>
        <td class="border px-2 py-1">${log.t4 || ""}</td>
        <td class="border px-2 py-1">${log.statusDay || ""}</td>
      `;
      body.appendChild(tr);
    });
  }

  // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin
  function renderAdminEmployeeTable() {
    const tbody = document.getElementById("admin-emp-table-body");
    if (!tbody) return;
    tbody.innerHTML = "";

    state.employees.forEach((emp) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="border px-2 py-1">${emp.code || ""}</td>
        <td class="border px-2 py-1">${emp.fullName || ""}</td>
        <td class="border px-2 py-1">${emp.branch || ""}</td>
        <td class="border px-2 py-1">${emp.level || ""}</td>
        <td class="border px-2 py-1">${emp.email || ""}</td>
        <td class="border px-2 py-1 text-center">
          <button class="text-xs text-indigo-600 hover:underline" data-code="${emp.code}">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    // ‡∏ú‡∏π‡∏Å event "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"
    tbody.querySelectorAll("button[data-code]").forEach((btn) => {
      btn.addEventListener("click", () => {
        const code = btn.getAttribute("data-code");
        const emp = state.employees.find((e) => String(e.code) === String(code));
        if (!emp) return;
        openEmployeeModalForEdit(emp);
      });
    });
  }

  /**********************
   * ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (admin)
   **********************/
  async function onSaveEmployee() {
    const formStatus = document.getElementById("employee-form-status");
    formStatus.textContent = "";
    formStatus.classList.remove("text-red-500", "text-emerald-600");

    const id = document.getElementById("emp-id").value.trim();
    const code = document.getElementById("emp-code").value.trim();
    const name = document.getElementById("emp-name").value.trim();
    const branch = document.getElementById("emp-branch").value.trim();
    const level = document.getElementById("emp-level").value.trim();
    const email = document.getElementById("emp-email").value.trim();
    const photoUrl = "";
    const faceData = "";

    if (!code || !name || !branch || !level) {
      formStatus.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö";
      formStatus.classList.add("text-red-500");
      return;
    }

    try {
      const result = await callApi("saveEmployee", {
        id,
        code,
        fullName: name,
        branch,
        level,
        email,
        photoUrl,
        faceData,
      });

      formStatus.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (id: " + result.id + ")";
      formStatus.classList.add("text-emerald-600");

      document.getElementById("emp-id").value = "";
      document.getElementById("emp-code").value = "";
      document.getElementById("emp-name").value = "";
      document.getElementById("emp-email").value = "";
      document.getElementById("emp-branch").value = "";
      document.getElementById("emp-level").value = "";

      await loadInitialData();
      renderAdminEmployeeTable();
    } catch (err) {
      console.error(err);
      formStatus.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
      formStatus.classList.add("text-red-500");
    }
  }

  function openEmployeeModalForAdd() {
    document.getElementById("emp-id").value = "";
    document.getElementById("emp-code").value = "";
    document.getElementById("emp-name").value = "";
    document.getElementById("emp-email").value = "";
    document.getElementById("emp-branch").value = "";
    document.getElementById("emp-level").value = "";
    document.getElementById("employee-form-status").textContent = "";
    openModal(document.getElementById("employee-modal"));
  }

  function openEmployeeModalForEdit(emp) {
    document.getElementById("emp-id").value = emp.id || "";
    document.getElementById("emp-code").value = emp.code || "";
    document.getElementById("emp-name").value = emp.fullName || "";
    document.getElementById("emp-email").value = emp.email || "";
    document.getElementById("emp-branch").value = emp.branch || "";
    document.getElementById("emp-level").value = emp.level || "";
    document.getElementById("employee-form-status").textContent = "";
    openModal(document.getElementById("employee-modal"));
  }

  /**********************
   * ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠
   **********************/
  function findEmployeeByCode(code) {
    return state.employees.find((e) => String(e.code) === String(code));
  }

  function showManualEmpInfo(text, isError) {
    const box = document.getElementById("manual-emp-box");
    box.textContent = text;
    box.classList.remove("text-red-600", "text-emerald-700");
    if (isError) box.classList.add("text-red-600");
  }

  async function handleManualFindEmp() {
    const code = document.getElementById("manual-code-input").value.trim();
    manualSelectedEmp = null;

    if (!code) {
      showManualEmpInfo("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô", true);
      return;
    }

    const emp = findEmployeeByCode(code);
    if (!emp) {
      showManualEmpInfo("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡πâ HR ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô", true);
      return;
    }

    manualSelectedEmp = emp;
    showManualEmpInfo(
      `‡∏£‡∏´‡∏±‡∏™: ${emp.code || "-"} | ‡∏ä‡∏∑‡πà‡∏≠: ${emp.fullName || "-"} | ‡πÅ‡∏ú‡∏ô‡∏Å: ${
        emp.branch || "-"
      } | ‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${emp.level || "-"}`,
      false
    );
  }

  async function handleManualSubmit() {
    const statusEl = document.getElementById("manual-status");
    statusEl.textContent = "";
    statusEl.classList.remove("text-red-500", "text-emerald-600");

    if (!manualSelectedEmp) {
      statusEl.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏Å‡∏î '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' ‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô";
      statusEl.classList.add("text-red-500");
      return;
    }

    const noteType = document.getElementById("manual-type-select").value || "";
    try {
      const result = await callApi("logScan", {
        code: manualSelectedEmp.code || "",
        fullName: manualSelectedEmp.fullName || "",
        branch: manualSelectedEmp.branch || "",
        level: manualSelectedEmp.level || "",
        note: "manual: " + noteType,
      });

      // update last-log panel ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
      document.getElementById("last-log-code").textContent =
        manualSelectedEmp.code || "";
      document.getElementById("last-log-name").textContent =
        manualSelectedEmp.fullName || "";
      document.getElementById("last-log-type").textContent =
        result.type || "-";
      document.getElementById("last-log-time").textContent =
        result.time || "-";
      document.getElementById("last-log-status").textContent =
        result.statusDay
          ? "‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô: " + result.statusDay
          : "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";

      statusEl.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏ß‡∏•‡∏≤ " + (result.time || "-");
      statusEl.classList.add("text-emerald-600");

      await loadInitialData();
    } catch (err) {
      console.error(err);
      statusEl.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
      statusEl.classList.add("text-red-500");
    }
  }

  /**********************
   * ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)
   **********************/
  async function handleCheckTime() {
    const code = document.getElementById("checktime-code-input").value.trim();
    const resultBox = document.getElementById("checktime-result");
    resultBox.classList.remove("text-red-600");
    resultBox.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...";

    if (!code) {
      resultBox.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô";
      resultBox.classList.add("text-red-600");
      return;
    }

    try {
      const result = await callApi("getTodayByCode", { code });
      if (!result.found) {
        resultBox.textContent = result.message || "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ";
        return;
      }

      const log = result.log || {};
      resultBox.innerHTML = `
        <div>‡∏£‡∏´‡∏±‡∏™: <span class="font-medium">${log.code || "-"}</span></div>
        <div>‡∏ä‡∏∑‡πà‡∏≠: <span class="font-medium">${log.fullName || "-"}</span></div>
        <hr class="my-2">
        <div>‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πâ‡∏≤ (T1): <span class="font-medium">${log.t1 || "-"}</span></div>
        <div>‡∏≠‡∏≠‡∏Å‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á (T2): <span class="font-medium">${log.t2 || "-"}</span></div>
        <div>‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á (T3): <span class="font-medium">${log.t3 || "-"}</span></div>
        <div>‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô (T4): <span class="font-medium">${log.t4 || "-"}</span></div>
        <hr class="my-2">
        <div>‡πÄ‡∏ä‡πâ‡∏≤: <span class="font-medium">${log.statusMorning || "-"}</span></div>
        <div>‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á: <span class="font-medium">${log.statusLunch || "-"}</span></div>
        <div>‡πÄ‡∏¢‡πá‡∏ô: <span class="font-medium">${log.statusAfternoon || "-"}</span></div>
        <div>‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô: <span class="font-semibold">${log.statusDay || "-"}</span></div>
      `;
    } catch (err) {
      console.error(err);
      resultBox.textContent = "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
      resultBox.classList.add("text-red-600");
    }
  }

  /**********************
   * Admin login / logout + nav
   **********************/
  function showAdminPage() {
    document.getElementById("front-page").classList.add("hidden");
    document.getElementById("admin-page").classList.remove("hidden");
  }

  function showFrontPage() {
    document.getElementById("admin-page").classList.add("hidden");
    document.getElementById("front-page").classList.remove("hidden");
  }

  function setAdminNav(active) {
    const dashBtn = document.getElementById("admin-nav-dashboard");
    const empBtn = document.getElementById("admin-nav-employees");
    const dashPage = document.getElementById("admin-dashboard");
    const empPage = document.getElementById("admin-employees");

    dashBtn.classList.remove("bg-slate-800");
    empBtn.classList.remove("bg-slate-800");
    dashPage.classList.add("hidden");
    empPage.classList.add("hidden");

    if (active === "dashboard") {
      dashBtn.classList.add("bg-slate-800");
      dashPage.classList.remove("hidden");
    } else if (active === "employees") {
      empBtn.classList.add("bg-slate-800");
      empPage.classList.remove("hidden");
    }
  }

  async function handleAdminLogin() {
    const user = document.getElementById("admin-login-user").value.trim();
    const pass = document.getElementById("admin-login-pass").value.trim();
    const errEl = document.getElementById("admin-login-error");
    errEl.textContent = "";

    if (user === ADMIN_USER && pass === ADMIN_PASS) {
      isAdminLoggedIn = true;
      closeModal(document.getElementById("admin-login-modal"));
      showAdminPage();
      setAdminNav("dashboard");
      await loadInitialData();
    } else {
      errEl.textContent = "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    }
  }

  function handleAdminLogout() {
    isAdminLoggedIn = false;
    showFrontPage();
  }

  /**********************
   * INIT
   **********************/
  document.addEventListener("DOMContentLoaded", async () => {
    // ‡πÇ‡∏´‡∏•‡∏î URL ‡∏à‡∏≤‡∏Å localStorage
    const saved = localStorage.getItem(LS_KEY_URL);
    if (saved) {
      webAppUrl = saved;
      document.getElementById("webapp-url-input").value = saved;
      loadInitialData();
    } else {
      openModal(document.getElementById("config-modal"));
    }

    // ‡∏õ‡∏∏‡πà‡∏° Config URL
    document
      .getElementById("btn-open-config")
      .addEventListener("click", () =>
        openModal(document.getElementById("config-modal"))
      );
    document
      .getElementById("btn-config-save")
      .addEventListener("click", onSaveWebAppUrl);
    document
      .getElementById("btn-config-cancel")
      .addEventListener("click", () =>
        closeModal(document.getElementById("config-modal"))
      );
    document
      .getElementById("btn-reset-url")
      .addEventListener("click", resetUrl);

    // ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤ front
    document
      .getElementById("btn-open-manual-log")
      .addEventListener("click", () => {
        manualSelectedEmp = null;
        document.getElementById("manual-code-input").value = "";
        showManualEmpInfo("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™", false);
        document.getElementById("manual-status").textContent = "";
        openModal(document.getElementById("manual-log-modal"));
      });

    document
      .getElementById("btn-open-checktime")
      .addEventListener("click", () => {
        document.getElementById("checktime-code-input").value = "";
        document.getElementById("checktime-result").textContent =
          "‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á ‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£";
        openModal(document.getElementById("checktime-modal"));
      });

    document
      .getElementById("btn-open-admin-login")
      .addEventListener("click", () => {
        document.getElementById("admin-login-user").value = "";
        document.getElementById("admin-login-pass").value = "";
        document.getElementById("admin-login-error").textContent = "";
        openModal(document.getElementById("admin-login-modal"));
      });

    document
      .getElementById("btn-refresh-front-dashboard")
      .addEventListener("click", loadInitialData);

    // modal manual log
    document
      .getElementById("btn-manual-find-emp")
      .addEventListener("click", handleManualFindEmp);
    document
      .getElementById("btn-manual-submit")
      .addEventListener("click", handleManualSubmit);
    document
      .getElementById("btn-manual-cancel")
      .addEventListener("click", () =>
        closeModal(document.getElementById("manual-log-modal"))
      );

    // modal checktime
    document
      .getElementById("btn-checktime-submit")
      .addEventListener("click", handleCheckTime);
    document
      .getElementById("btn-checktime-close")
      .addEventListener("click", () =>
        closeModal(document.getElementById("checktime-modal"))
      );

    // admin login modal
    document
      .getElementById("btn-admin-login-submit")
      .addEventListener("click", handleAdminLogin);
    document
      .getElementById("btn-admin-login-cancel")
      .addEventListener("click", () =>
        closeModal(document.getElementById("admin-login-modal"))
      );

    // admin sidebar nav
    document
      .getElementById("admin-nav-dashboard")
      .addEventListener("click", () => setAdminNav("dashboard"));
    document
      .getElementById("admin-nav-employees")
      .addEventListener("click", () => setAdminNav("employees"));

    // admin top buttons
    document
      .getElementById("btn-admin-refresh")
      .addEventListener("click", loadInitialData);
    document
      .getElementById("btn-admin-emp-refresh")
      .addEventListener("click", loadInitialData);
    document
      .getElementById("btn-admin-emp-add")
      .addEventListener("click", openEmployeeModalForAdd);
    document
      .getElementById("btn-admin-logout")
      .addEventListener("click", handleAdminLogout);

    // employee modal close / cancel / save
    document
      .getElementById("btn-employee-close")
      .addEventListener("click", () =>
        closeModal(document.getElementById("employee-modal"))
      );
    document
      .getElementById("btn-employee-cancel")
      .addEventListener("click", () =>
        closeModal(document.getElementById("employee-modal"))
      );
    document
      .getElementById("btn-employee-save")
      .addEventListener("click", (e) => {
        e.preventDefault();
        onSaveEmployee();
      });
  });
</script>
</body>
</html>
